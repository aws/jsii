#!/usr/bin/env python3
import os
import subprocess
import sys

subprocess.run(
    [
        "jsii-pacmak",
        "-t",
        "python",
        "-o",
        ".env/jsii-calc",
        "--recurse",
        "node_modules/jsii-calc",
    ],
    check=True,
)
subprocess.run(
    [
        sys.executable,
        "-m",
        "pip",
        "install",
        "--force-reinstall",
        "--upgrade",
        "--find-links",
        os.path.abspath("."),
    ]
    + ["jsii"]  # TODO: Remove this.
    + [d for d in os.listdir(".env/jsii-calc") if d.endswith(".whl")],
    cwd=os.path.abspath(".env/jsii-calc"),
    check=True,
)
